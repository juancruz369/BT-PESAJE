<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Software de Pesaje</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f4;
            text-align: center;
        }
        h1 {
            color: #333;
        }
        .container {
            max-width: 800px;
            margin: auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .peso-display {
            font-size: 30px;
            font-weight: bold;
            margin: 20px 0;
            color: #007bff;
        }
        .button-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }
        button {
            padding: 10px 20px;
            border: none;
            background-color: #007bff;
            color: white;
            font-size: 16px;
            cursor: pointer;
            border-radius: 5px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .hidden {
            display: none;
        }
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 10px;
            width: 80%;
            max-width: 500px;
            text-align: left;
            position: relative;
        }
        .modal-content label {
            display: block;
            margin-top: 10px;
            font-weight: bold;
        }
        .modal-content input {
            width: calc(100% - 20px);
            padding: 8px;
            margin-top: 5px;
        }
        .modal-content .close-button {
            margin-top: 15px;
            background-color: red;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Software de Pesaje</h1>
        
        <!-- üèãÔ∏è PESO ACTUAL QUE TRANSMITE EL INDICADOR -->
        <div class="peso-display" id="pesoActual">Peso: 0 kg</div>

        <div class="button-container">
            <button onclick="capturarPeso()">Capturar</button>
            <button onclick="mostrarFormulario('entraCamion')">Entra Cami√≥n</button>
            <button onclick="mostrarFormulario('saleCamion')">Sale Cami√≥n</button>
            <button onclick="mostrarFormulario('saleCamionTara')">Sale Cami√≥n c/Tara</button>
            <button onclick="mostrarFormulario('pesadas')">Pesadas</button>
            <button onclick="mostrarFormulario('anularPesada')">Anular Pesada</button>
        </div>
    </div>

    <!-- MODAL (se muestra solo cuando se necesita) -->
    <div id="modal" class="modal hidden">
        <div class="modal-content">
            <h2 id="modal-title">Formulario</h2>
            <div id="form-content">
                <label for="peso">Peso:</label>
                <input type="text" id="peso" placeholder="Ingrese peso">
            </div>
            <button class="close-button" onclick="cerrarModal()">Cerrar</button>
        </div>
    </div>

    <script>
        let pesoCapturado = 0; 

        // Simulaci√≥n de la lectura del indicador (se actualizar√≠a con RS232)
        function actualizarPesoSimulado() {
            let pesoRandom = Math.floor(Math.random() * 50000) + 1000; // Simula valores entre 1000 y 50000 kg
            document.getElementById("pesoActual").innerText = `Peso: ${pesoRandom} kg`;
        }
        setInterval(actualizarPesoSimulado, 3000); // Actualiza cada 3 segundos

        function capturarPeso() {
            let pesoActualTexto = document.getElementById("pesoActual").innerText;
            pesoCapturado = parseInt(pesoActualTexto.replace("Peso: ", "").replace(" kg", ""), 10);
            alert(`Peso capturado: ${pesoCapturado} kg`);
        }

        function mostrarFormulario(tipo) {
            const modal = document.getElementById("modal");
            const modalTitle = document.getElementById("modal-title");
            const formContent = document.getElementById("form-content");

            formContent.innerHTML = '';

            if (tipo === "entraCamion") {
                modalTitle.innerText = "Datos del Cami√≥n - Entrada";
                formContent.innerHTML = `
                    <label for="cuit">CUIT:</label>
                    <input type="text" id="cuit" placeholder="Ingrese CUIT">
                    <label for="dominio">Dominio:</label>
                    <input type="text" id="dominio" placeholder="Ingrese Dominio">
                    <label for="peso">Peso Tara:</label>
                    <input type="text" id="peso" value="${pesoCapturado} kg">
                `;
            } else if (tipo === "saleCamion") {
                modalTitle.innerText = "Datos del Cami√≥n - Salida";
                formContent.innerHTML = `
                    <label for="pesoBruto">Peso Bruto:</label>
                    <input type="text" id="pesoBruto" value="${pesoCapturado} kg">
                    <label for="pesoTara">Peso Tara (Opcional):</label>
                    <input type="text" id="pesoTara" placeholder="Ingrese Peso Tara">
                `;
            } else if (tipo === "saleCamionTara") {
                modalTitle.innerText = "Salida Cami√≥n con Tara";
                formContent.innerHTML = `
                    <label for="taraSeleccionada">Seleccionar Tara:</label>
                    <input type="text" id="taraSeleccionada" placeholder="Tara Anterior">
                    <label for="pesoBrutoActual">Peso Bruto Actual:</label>
                    <input type="text" id="pesoBrutoActual" value="${pesoCapturado} kg">
                `;
            } else if (tipo === "pesadas") {
                modalTitle.innerText = "B√∫squeda de Pesadas";
                formContent.innerHTML = `
                    <label for="filtroFecha">Filtrar por Fecha:</label>
                    <input type="date" id="filtroFecha">
                    <label for="filtroDominio">Filtrar por Dominio:</label>
                    <input type="text" id="filtroDominio" placeholder="Ingrese Dominio">
                `;
            }

            modal.classList.remove("hidden");
        }

        function cerrarModal() {
            document.getElementById("modal").classList.add("hidden");
        }

        window.onclick = function(event) {
            const modal = document.getElementById("modal");
            if (event.target === modal) {
                cerrarModal();
            }
        }
    </script>

</body>
</html>
